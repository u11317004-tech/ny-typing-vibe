<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç˜‹ç‹‚æ‰“åœ°é¼ ï¼šæ£®æ—å¤§å†’éšª</title>
    <style>
        /* --- è¦–è¦ºè¨­è¨ˆèˆ‡æ’ç‰ˆ --- */
        :root {
            --grass: #55a630;
            --dirt: #6d4c41;
            --wood: #a0522d;
            --font-main: 'Segoe UI', Microsoft JhengHei, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background: #87ceeb; /* å¤©è—è‰² */
            font-family: var(--font-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            cursor: url('https://cur.cursors-4u.net/games/gam-4/gam372.cur'), auto; /* å˜—è©¦è‡ªå®šç¾©æ§Œå­æ¸¸æ¨™ */
        }

        /* æ¨™é¡Œèˆ‡è¨ˆåˆ†æ¿ */
        .header {
            text-align: center;
            padding: 20px;
            color: #fff;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }

        .score-board {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 40px;
            border-radius: 50px;
            display: flex;
            gap: 40px;
            font-size: 24px;
            font-weight: 900;
            color: var(--wood);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 4px solid var(--wood);
        }

        /* éŠæˆ²è‰åœ°å€åŸŸ */
        .game-area {
            margin-top: 30px;
            width: 600px;
            height: 400px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 20px;
            background: var(--grass);
            padding: 40px;
            border-radius: 40px;
            border-bottom: 15px solid #2d6a4f;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }

        /* åœ°æ´è¨­è¨ˆ */
        .hole {
            background: #3e2723;
            border-radius: 50% / 30%;
            position: relative;
            overflow: hidden; /* é—œéµï¼šéš±è—åœ°é¼  */
            box-shadow: inset 0 10px 20px #000;
        }

        /* åœ°é¼ è¨­è¨ˆ */
        .mole {
            width: 100%;
            height: 100%;
            background: #8d6e63;
            position: absolute;
            bottom: -100%; /* é è¨­åœ¨æ´åº• */
            border-radius: 50% 50% 10% 10%;
            transition: bottom 0.1s cubic-bezier(0.17, 0.67, 0.83, 0.67);
            cursor: pointer;
        }

        .mole::before, .mole::after { /* çœ¼ç› */
            content: '';
            position: absolute;
            background: #000;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            top: 25%;
        }
        .mole::before { left: 25%; }
        .mole::after { right: 25%; }

        .mole-nose {
            position: absolute;
            width: 16px;
            height: 10px;
            background: #ff7043;
            border-radius: 50%;
            top: 45%;
            left: 50%;
            transform: translateX(-50%);
        }

        .mole.up { bottom: 0; }

        /* æ“Šä¸­å‹•ç•« */
        .mole.hit {
            background: #d32f2f !important;
            transform: scale(0.9);
        }

        /* éŠæˆ²é–‹å§‹/çµæŸ è¦†è“‹å±¤ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: white;
            text-align: center;
        }

        .modal {
            background: white;
            color: #333;
            padding: 40px;
            border-radius: 20px;
            max-width: 400px;
            box-shadow: 0 0 30px #f1c40f;
        }

        .modal h2 { color: var(--wood); margin-top: 0; }
        .modal ul { text-align: left; line-height: 1.6; }

        .start-btn {
            background: #e67e22;
            color: white;
            padding: 15px 40px;
            font-size: 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
            margin-top: 20px;
        }

        .start-btn:hover { background: #d35400; transform: scale(1.05); }

        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="gameOverlay" class="overlay">
        <div class="modal">
            <h2 id="modalTitle">ğŸªµ æ£®æ—æ‰“åœ°é¼  ğŸªµ</h2>
            <div id="rules">
                <p><strong>éŠç©è¦å‰‡ï¼š</strong></p>
                <ul>
                    <li>é»æ“Šã€Œé–‹å§‹éŠæˆ²ã€å¾Œæœ‰ 30 ç§’æŒ‘æˆ°æ™‚é–“ã€‚</li>
                    <li>åœ°é¼ æœƒå¾åœ°æ´ä¸­éš¨æ©Ÿå†’å‡ºã€‚</li>
                    <li>ç”¨ä½ çš„æ»‘é¼ ï¼ˆæ§Œå­ï¼‰é»æ“Šåœ°é¼ ã€‚</li>
                    <li>æ¯æ‰“ä¸­ä¸€éš»å¾— 1 åˆ†ï¼Œæ¼æ‰ä¸æ‰£åˆ†ã€‚</li>
                </ul>
            </div>
            <p id="finalScore" class="hidden"></p>
            <button class="start-btn" onclick="initGame()">é–‹å§‹æŒ‘æˆ°</button>
        </div>
    </div>

    <div class="header">
        <h1>ğŸ”¨ WHACK-A-MOLE ğŸ”¨</h1>
        <div class="score-board">
            <div>å¾—åˆ†ï¼š<span id="scoreText">0</span></div>
            <div>å‰©é¤˜ï¼š<span id="timerText">30</span>s</div>
        </div>
    </div>

    <div class="game-area">
        <div class="hole"><div class="mole" onclick="handleWhack(this)"><div class="mole-nose"></div></div></div>
        <div class="hole"><div class="mole" onclick="handleWhack(this)"><div class="mole-nose"></div></div></div>
        <div class="hole"><div class="mole" onclick="handleWhack(this)"><div class="mole-nose"></div></div></div>
        <div class="hole"><div class="mole" onclick="handleWhack(this)"><div class="mole-nose"></div></div></div>
        <div class="hole"><div class="mole" onclick="handleWhack(this)"><div class="mole-nose"></div></div></div>
        <div class="hole"><div class="mole" onclick="handleWhack(this)"><div class="mole-nose"></div></div></div>
    </div>

    <script>
        const moles = document.querySelectorAll('.mole');
        const scoreText = document.getElementById('scoreText');
        const timerText = document.getElementById('timerText');
        const overlay = document.getElementById('gameOverlay');
        const modalTitle = document.getElementById('modalTitle');
        const finalScoreDisplay = document.getElementById('finalScore');
        const rulesDisplay = document.getElementById('rules');

        let score = 0;
        let timeLeft = 30;
        let isGameActive = false;
        let lastHoleIndex = -1;

        // åˆå§‹åŒ–/é‡ç½®éŠæˆ²
        function initGame() {
            score = 0;
            timeLeft = 30;
            isGameActive = true;
            scoreText.innerText = score;
            timerText.innerText = timeLeft;
            
            overlay.classList.add('hidden'); // éš±è—é®ç½©
            
            startGameTimer();
            showRandomMole();
        }

        // æ™‚é–“å€’æ•¸é‚è¼¯
        function startGameTimer() {
            const countdown = setInterval(() => {
                timeLeft--;
                timerText.innerText = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    endGame();
                }
            }, 1000);
        }

        // åœ°é¼ å†’å‡ºé‚è¼¯
        function showRandomMole() {
            if (!isGameActive) return;

            // éš¨æ©Ÿé¸æ“‡åœ°æ´ï¼ˆä¸é‡è¤‡ä¸Šä¸€æ¬¡ï¼‰
            let index;
            do {
                index = Math.floor(Math.random() * moles.length);
            } while (index === lastHoleIndex);
            
            lastHoleIndex = index;
            const mole = moles[index];

            mole.classList.add('up');

            // æ ¹æ“šå¾—åˆ†å¢åŠ é›£åº¦ï¼ˆåœ°é¼ åœç•™æ™‚é–“ç¸®çŸ­ï¼‰
            const stayDuration = Math.max(500, 1200 - (score * 20));

            setTimeout(() => {
                mole.classList.remove('up');
                mole.classList.remove('hit');
                if (isGameActive) showRandomMole();
            }, stayDuration);
        }

        // é»æ“Šæ‰“åœ°é¼ 
        function handleWhack(moleElement) {
            if (!isGameActive || !moleElement.classList.contains('up')) return;

            score++;
            scoreText.innerText = score;
            
            moleElement.classList.add('hit');
            moleElement.classList.remove('up');

            // å¯ä»¥åœ¨æ­¤åŠ å…¥éœ‡å‹•æˆ–éŸ³æ•ˆ
            if (navigator.vibrate) navigator.vibrate(50); 
        }

        // çµæŸéŠæˆ²
        function endGame() {
            isGameActive = false;
            overlay.classList.remove('hidden');
            modalTitle.innerText = "ğŸ’¥ æ™‚é–“åˆ°ï¼";
            rulesDisplay.classList.add('hidden');
            finalScoreDisplay.classList.remove('hidden');
            finalScoreDisplay.innerHTML = `<h3>ä½ çš„æœ€çµ‚å¾—åˆ†æ˜¯ï¼š<span style="color: #e67e22; font-size: 40px;">${score}</span></h3>`;
            document.querySelector('.start-btn').innerText = "å†ç©ä¸€æ¬¡";
        }
    </script>
</body>
</html>